/*!
 * @package   yii2-export
 * @author    Kartik Visweswaran <kartikv2@gmail.com>
 * @copyright Copyright &copy; Kartik Visweswaran, Krajee.com, 2015 - 2018
 * @version   1.3.3
 *
 * Export Data Validation Module.
 *
 * Author: Kartik Visweswaran
 * Copyright: 2015, Kartik Visweswaran, Krajee.com
 * For more JQuery plugins visit http://plugins.krajee.com
 * For more Yii related demos visit http://demos.krajee.com
 */
!function(t){"use strict";var e={isEmpty:function(e,o){return null===e||void 0===e||e===[]||""===e||o&&""===t.trim(e)},popupDialog:function(t,e,o,n){var p=screen.width/2-o/2,a=60,i=window.open("",e,"",!0);return i.close(),window.open(t,e,"toolbar=no, location=no, directories=no, status=yes, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+o+", height="+n+", top="+a+", left="+p)},popupTemplate:'<html style="display:table;width:100%;height:100%;"><title>Export Data - &copy; Krajee</title><body style="display:table-cell;font-family:Helvetica,Arial,sans-serif;color:#888;font-weight:bold;line-height:1.4em;text-align:center;vertical-align:middle;width:100%;height:100%;padding:0 10px;">{msg}</body></html>'},o=function(e,o){var n=this;n.$element=t(e),t.each(o,function(t,e){n[t]=e}),n.popup="",n.listen()};o.prototype={constructor:o,setPopupAlert:function(t){var o=this;if(o.popup.document)if(arguments.length&&arguments[1]){var n=o.popup.document.getElementsByTagName("body");setTimeout(function(){n[0].innerHTML=t},1800)}else{var p=e.popupTemplate.replace("{msg}",t);o.popup.document.write(p)}},listen:function(){var t=this;t.listenClick()},processExport:function(o){var n,p,a,i,r,s,l=this,d=[],u=window.yii,c=l.settings,m=function(e,o){return t("<input/>",{type:"hidden",name:e,value:o})};a="_popup"===c.target,a&&(l.popup=e.popupDialog("","kvExportFullDialog",350,120),l.popup.focus(),l.setPopupAlert(l.settings.messages.downloadProgress)),p=u?m(u.getCsrfParam()||"_csrf",u.getCsrfToken()||null):null,r="",e.isEmpty(c.colSelId)||(n=t("#"+c.colSelId).parent().find('input[name="export_columns_selector[]"]'),n.each(function(){var e=t(this);e.is(":checked")&&d.push(e.attr("data-key"))}),r=JSON.stringify(d)),i=t.extend(!0,{},c.formOptions,{action:window.location.href,method:"post",css:{display:"none"}}),s=t("<form/>",i).append(p).append(m(c.exportTypeParam,o),m(c.exportRequestParam,1)).append(m(c.exportColsParam,r),m(c.colSelFlagParam,c.colSelEnabled)).appendTo("body"),e.isEmpty(c.exportFormHiddenInputs)||t.each(c.exportFormHiddenInputs,function(e,o){var n={name:e,value:o.value||null,type:"hidden"};n=t.extend({},n,o.options||{}),s.append(t("<input/>",n))}),s.submit().remove(),a&&l.setPopupAlert(l.settings.messages.downloadComplete,!0)},listenClick:function(){var o=this;o.$element.off("click.exportmenu").on("click.exportmenu",function(n){var p,a,i,r,s,l="",d=window[o.settings.dialogLib];return p=t(this).data("format"),n.preventDefault(),n.stopPropagation(),o.settings.showConfirmAlert?(a=o.settings.messages,i=e.isEmpty(o.alertMsg)?"":o.alertMsg,r=e.isEmpty(a.allowPopups)?"":a.allowPopups,s=e.isEmpty(a.confirmDownload)?"":a.confirmDownload,l=i.length&&r.length?i+"\n\n"+r:!i.length&&r.length?r:i.length&&!r.length?i:"",s.length&&(l=l+"\n\n"+s),e.isEmpty(l)?void o.processExport(p):void d.confirm(l,function(t){t&&o.processExport(p)})):void o.processExport(p)})}},t.fn.exportdata=function(e){var n=Array.apply(null,arguments);return n.shift(),this.each(function(){var p=t(this),a=p.data("exportdata"),i="object"==typeof e&&e;a||p.data("exportdata",a=new o(this,t.extend({},t.fn.exportdata.defaults,i,t(this).data()))),"string"==typeof e&&a[e].apply(a,n)})},t.fn.exportdata.defaults={alertMsg:"",settings:{formOptions:{},exportType:"",colSelEnabled:"",exportRequestParam:"",exportTypeParam:"",exportColsParam:"",exportFormHiddenInputs:{},colSelId:null,target:"_popup",showConfirmAlert:!0,dialogLib:"krajeeDialog",messages:{allowPopups:"",confirmDownload:"",downloadProgress:"",downloadComplete:""}}}}(window.jQuery);