/*!
 * @package   yii2-export
 * @author    Kartik Visweswaran <kartikv2@gmail.com>
 * @copyright Copyright &copy; Kartik Visweswaran, Krajee.com, 2015 - 2018
 * @version   1.3.2
 *
 * Export Data Validation Module.
 *
 * Author: Kartik Visweswaran
 * Copyright: 2015, Kartik Visweswaran, Krajee.com
 * For more JQuery plugins visit http://plugins.krajee.com
 * For more Yii related demos visit http://demos.krajee.com
 */!function(t){"use strict";var o={isEmpty:function(o,e){return null===o||void 0===o||o===[]||""===o||e&&""===t.trim(o)},popupDialog:function(t,o,e,n){var i=screen.width/2-e/2;return window.open("",o,"",!0).close(),window.open(t,o,"toolbar=no, location=no, directories=no, status=yes, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+e+", height="+n+", top=60, left="+i)},popupTemplate:'<html style="display:table;width:100%;height:100%;"><title>Export Data - &copy; Krajee</title><body style="display:table-cell;font-family:Helvetica,Arial,sans-serif;color:#888;font-weight:bold;line-height:1.4em;text-align:center;vertical-align:middle;width:100%;height:100%;padding:0 10px;">{msg}</body></html>'},e=function(o,e){var n=this;n.$element=t(o),t.each(e,function(t,o){n[t]=o});var i=e.settings;n.$form=t("#"+i.formId),n.messages=i.messages,n.popup="",n.listen()};e.prototype={constructor:e,setPopupAlert:function(t){var e=this;if(e.popup.document)if(arguments.length&&arguments[1]){var n=e.popup.document.getElementsByTagName("body");setTimeout(function(){n[0].innerHTML=t},4e3)}else{var i=o.popupTemplate.replace("{msg}",t);e.popup.document.write(i)}},listen:function(){var t=this;t.$form.attr("action",window.location.href).appendTo("body"),t.listenClick(),"_popup"===t.target&&t.$form.off("submit.exportmenu").on("submit.exportmenu",function(){setTimeout(function(){t.setPopupAlert(t.messages.downloadComplete,!0)},1e3)})},processExport:function(e){var n=this,i=[];n.$form.attr("action",window.location.href).appendTo("body"),n.$form.find('[name="export_type"]').val(e),"_popup"===n.target&&(n.popup=o.popupDialog("","kvExportFullDialog",350,120),n.popup.focus(),n.setPopupAlert(n.messages.downloadProgress)),o.isEmpty(n.columnSelectorId)||(t("#"+n.columnSelectorId).parent().find('input[name="export_columns_selector[]"]').each(function(){var o=t(this);o.is(":checked")&&i.push(o.attr("data-key"))}),n.$form.find('input[name="export_columns"]').val(JSON.stringify(i))),n.$form.trigger("submit")},listenClick:function(){var e=this;e.$element.off("click.exportmenu").on("click.exportmenu",function(n){var i,a,r,p,l,s="",u=window[e.dialogLib];i=t(this).data("format"),n.preventDefault(),n.stopPropagation(),e.showConfirmAlert?(a=e.messages,r=o.isEmpty(e.alertMsg)?"":e.alertMsg,p=o.isEmpty(a.allowPopups)?"":a.allowPopups,l=o.isEmpty(a.confirmDownload)?"":a.confirmDownload,s=r.length&&p.length?r+"\n\n"+p:!r.length&&p.length?p:r.length&&!p.length?r:"",l.length&&(s=s+"\n\n"+l),o.isEmpty(s)?e.processExport(i):u.confirm(s,function(t){t&&e.processExport(i)})):e.processExport(i)})}},t.fn.exportdata=function(o){var n=Array.apply(null,arguments);return n.shift(),this.each(function(){var i=t(this),a=i.data("exportdata"),r="object"==typeof o&&o;a||i.data("exportdata",a=new e(this,t.extend({},t.fn.exportdata.defaults,r,t(this).data()))),"string"==typeof o&&a[o].apply(a,n)})},t.fn.exportdata.defaults={filename:"export",target:"_popup",showConfirmAlert:!0,columnSelectorId:null,alertMsg:"",dialogLib:"krajeeDialog",settings:{formId:"",messages:{allowPopups:"",confirmDownload:"",downloadProgress:"",downloadComplete:""}}}}(window.jQuery);